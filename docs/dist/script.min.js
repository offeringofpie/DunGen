!function(t){function e(e){for(var o,a,n=e[0],u=e[1],d=e[2],l=0,f=[];l<n.length;l++)a=n[l],s[a]&&f.push(s[a][0]),s[a]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);for(h&&h(e);f.length;)f.shift()();return r.push.apply(r,d||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],o=!0,n=1;n<i.length;n++){var u=i[n];0!==s[u]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},s={1:0},r=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var n=window.webpackJsonp=window.webpackJsonp||[],u=n.push.bind(n);n.push=e,n=n.slice();for(var d=0;d<n.length;d++)e(n[d]);var h=u;r.push([37,0]),i()}({36:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(38)),r=o(i(65)),a=o(i(67)),n=o(i(9)),u=function(){function t(){var t=this;this.dungeon=null,this.camera=new r.default,this.animate=new a.default,n.default.resize(),n.default.loadImg("./img/dungeon.png",function(){t.init()})}return t.prototype.init=function(){var t=this;n.default.buildGrid(),n.default.control.init(),this.dungeon=new s.default,this.animate.update=function(){n.default.ctx.clearRect(0,0,n.default.canvas.width,n.default.canvas.height),t.camera.update(),t.camera.setHome(),t.camera.setTransform(),t.dungeon.draw()},this.animate.start()},t.prototype.restart=function(){this.dungeon.restart()},t}();e.default=u},37:function(t,e,i){t.exports=i(70)},38:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=i(39),r=o(i(9)),a=o(i(64)),n=function(){function t(){this.ctx=r.default.canvas.getContext("2d"),this.pattern=new a.default,this.rooms=new Array,this.init()}return t.prototype.init=function(){this.setRooms()},t.prototype.restart=function(){this.init()},t.prototype.setRooms=function(t,e,i){for(var o=this,a=e||40,n=i||100,u=t||10,d=0;d<n;d++){for(var h=Math.floor(s.lerp(10,a)),l=Math.floor(s.lerp(10,a)),f=Math.floor(2*s.lerp(0,(r.default.gridSize-h)/2)+1),c=Math.floor(2*s.lerp(0,(r.default.gridSize-l)/2)+1),p=!1,m={x:f,y:c,w:h,h:l,c:{x:Math.ceil(f+h/2),y:Math.ceil(c+l/2)}},v=0;v<r.default.rooms.length;v++)s.intersect(m,r.default.rooms[v])&&(p=!0);!p&&r.default.rooms.length<u&&r.default.rooms.push(m)}r.default.rooms.forEach(function(t,e){for(var i=t.y;i<t.y+t.h-1;i++)for(var s=i==t.y?-1:i==t.y+t.h-1?1:0,a=t.x;a<t.x+t.w-1;a++){var n=a==t.x?-1:a==t.x+t.w-1?1:0;r.default.grid[i][a]={type:"floor",room:!0,edge:[s,n],index:e}}o._carve(r.default.rooms[Math.max(0,e-1)],t)}),this.addWalls()},t.prototype._isFloor=function(t,e){return"floor"===r.default.grid[t][e].type},t.prototype._isDoor=function(t,e){return"door"===r.default.grid[t][e].type},t.prototype._isEdge=function(t,e){return void 0!==r.default.grid[t][e].edge},t.prototype._isValid=function(t,e){return void 0!==r.default.grid[t]&&void 0!==r.default.grid[t][e]},t.prototype._carve=function(t,e){for(var i=t.c,o=e.c,s=Math.min(o.y,i.y);s<=Math.max(o.y,i.y);s++)r.default.grid[s][o.x].room||(r.default.grid[s][o.x]={type:"floor",room:!1,edge:[2,0]});for(var a=Math.min(i.x,o.x);a<=Math.max(i.x,o.x);a++)r.default.grid[i.y][a].room||(r.default.grid[i.y][a]={type:"floor",room:!1,edge:[0,2]})},t.prototype.addWalls=function(){for(var t=this,e=0;e<r.default.gridSize;++e)for(var i=0;i<r.default.gridSize;++i){if(this._isEdge(e,i))[[e-1,i-1],[e-1,i],[e-1,i+1],[e,i-1],[e,i],[e,i+1],[e+1,i-1],[e+1,i],[e+1,i+1]].forEach(function(e){!t._isValid(e[0],e[1])||t._isFloor(e[0],e[1])||t._isDoor(e[0],e[1])||(r.default.grid[e[0]][e[1]]={type:"wall"})})}},t.prototype.draw=function(){for(var t=0;t<r.default.gridSize;++t)for(var e=0;e<r.default.gridSize;++e){var i=r.default.grid[t][e].type;i&&(this.ctx.fillStyle=this.pattern.get(i),this.ctx.fillRect(r.default.cellSize.w*e,r.default.cellSize.h*t,r.default.cellSize.w,r.default.cellSize.h))}},t}();e.default=n},39:function(t,e,i){"use strict";i.r(e),i.d(e,"Random",function(){return o}),i.d(e,"boxMuller",function(){return s}),i.d(e,"closest",function(){return r}),i.d(e,"lerp",function(){return a}),i.d(e,"distance",function(){return n}),i.d(e,"intersect",function(){return u});class o{constructor(t=Math.random()){this.input=t,this.seed=this._convert(t),this.seed<=0&&(this.seed+=2147483646)}_convert(t){return t.toString().split("").map((e,i)=>t.toString().charCodeAt(i)).join("")%2147483647}getSeed(){return this.input}setSeed(t){this.input=t,this.seed=this._convert(t)}next(){return this.seed=16807*this.seed%2147483647,this.seed}nextFloat(){return(this.next()-1)/2147483646}}function s(t){const e=Math.random(),i=Math.random();return Math.max(Math.min(Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*i),t),-t)}function r(t,e){return Math.ceil(t/e)*e}function a(t,e,i=Math.random()){return(1-i)*t+i*e}function n([t,e],[i,o]){var s=t-i,r=e-o;return sqrt(s*s+r*r)}function u(t,e,i=0){return void 0!==e&&!(e.x>t.x+t.w+i||e.x+e.w+i<t.x||e.y>t.y+t.h+i||e.y+e.h+i<t.y)}},40:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(41)),r=o(i(9)),a=function(){function t(){this.kit=new s.default,this.options={size:[96,128,256,512],selection:null}}return t.prototype.init=function(){this.addUi()},t.prototype.addUi=function(){this.kit.addPanel().addGroup().addSubGroup().addNumberOutput(r.default.pos,"mouseX",{label:"x"}).addSelect(this.options,"size",{label:"size",onChange:function(t){r.default.gridSize=this.options.size[t],r.default.cellSize={w:r.default.width/r.default.gridSize,h:r.default.height/r.default.gridSize},r.default.buildGrid()}.bind(this)})},t}();e.default=a},64:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(9)),r={door:[16,0],wall:[80,0],floor:[160,96]},a=function(){function t(t,e,i,o){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.outerCtx=e||s.default.ctx,this.img=t||s.default.img,this.w=i||16,this.h=o||16,this.sprite=r,this.canvas.width=this.w,this.canvas.height=this.h}return t.prototype.get=function(t){var e=t||"floor";return this.ctx.drawImage(this.img,this.sprite[e][0],this.sprite[e][1],this.w,this.h,0,0,this.w,this.h),this.outerCtx.createPattern(this.canvas,"repeat")},t}();e.default=a},65:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(66)),r=o(i(9)),a=function(){function t(){this.x=0,this.y=0,this.ox=0,this.oy=0,this.scale=1,this.rotate=0,this.cx=0,this.cy=0,this.cox=0,this.coy=0,this.cscale=1,this.crotate=0,this.dx=0,this.dy=0,this.dox=0,this.doy=0,this.dscale=1,this.drotate=0,this.drag=.1,this.accel=2,this.matrix=[0,0,0,0,0,0],this.invMatrix=[0,0,0,0,0,0],this.mouse=new s.default,this.mouse.posX=0,this.mouse.posY=0,this.mouse.bind(r.default.canvas)}return t.prototype.setTransform=function(){var t=this.matrix,e=0;r.default.ctx.setTransform(t[e++],t[e++],t[e++],t[e++],t[e++],t[e++])},t.prototype.setHome=function(){r.default.ctx.setTransform(1,0,0,1,0,0)},t.prototype.update=function(){this.dx+=(this.x-this.cx)*this.accel,this.dy+=(this.y-this.cy)*this.accel,this.dox+=(this.ox-this.cox)*this.accel,this.doy+=(this.oy-this.coy)*this.accel,this.dscale+=(this.scale-this.cscale)*this.accel,this.drotate+=(this.rotate-this.crotate)*this.accel,this.dx*=this.drag,this.dy*=this.drag,this.dox*=this.drag,this.doy*=this.drag,this.dscale*=this.drag,this.drotate*=this.drag,this.cx+=this.dx,this.cy+=this.dy,this.cox+=this.dox,this.coy+=this.doy,this.cscale+=this.dscale,this.crotate+=this.drotate,this.matrix[0]=Math.cos(this.crotate)*this.cscale,this.matrix[1]=Math.sin(this.crotate)*this.cscale,this.matrix[2]=-this.matrix[1],this.matrix[3]=this.matrix[0],this.matrix[4]=-(this.cx*this.matrix[0]+this.cy*this.matrix[2])+this.cox,this.matrix[5]=-(this.cx*this.matrix[1]+this.cy*this.matrix[3])+this.coy;var t=this.matrix[0]*this.matrix[3]-this.matrix[1]*this.matrix[2];if(this.invMatrix[0]=this.matrix[3]/t,this.invMatrix[1]=-this.matrix[1]/t,this.invMatrix[2]=-this.matrix[2]/t,this.invMatrix[3]=this.matrix[0]/t,void 0!==r.default.pos){if(void 0!==r.default.pos.oldX&&1==(1&r.default.pos.buttonRaw)){var e=r.default.pos.x-r.default.pos.oldX,i=r.default.pos.y-r.default.pos.oldY,o=e*this.invMatrix[0]+i*this.invMatrix[2],s=e*this.invMatrix[1]+i*this.invMatrix[3];this.x-=o,this.y-=s}void 0!==r.default.pos.w&&0!==r.default.pos.w&&(this.ox=r.default.pos.x,this.oy=r.default.pos.y,this.x=r.default.pos.posX,this.y=r.default.pos.posY,r.default.pos.w>0&&(this.scale*=1.1,r.default.pos.w-=20,r.default.pos.w<0&&(r.default.pos.w=0)),r.default.pos.w<0&&(this.scale*=1/1.1,r.default.pos.w+=20,r.default.pos.w>0&&(r.default.pos.w=0)));var a=r.default.pos.x-this.cox,n=r.default.pos.y-this.coy;r.default.pos.posX=this.cx+(a*this.invMatrix[0]+n*this.invMatrix[2]),r.default.pos.posY=this.cy+(a*this.invMatrix[1]+n*this.invMatrix[3]),r.default.pos.rx=r.default.pos.posX,r.default.pos.ry=r.default.pos.posY,r.default.pos.oldX=r.default.pos.x,r.default.pos.oldY=r.default.pos.y}},t}();e.default=a},66:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(9)),r=function(){function t(){}return t.prototype.bind=function(t){t.addEventListener("mousemove",this.mouse.bind(this)),t.addEventListener("mousedown",this.mouse.bind(this)),t.addEventListener("mouseup",this.mouse.bind(this)),t.addEventListener("mouseout",this.mouse.bind(this)),t.addEventListener("mouseover",this.mouse.bind(this)),t.addEventListener("mousewheel",this.mouse.bind(this)),t.addEventListener("DOMMouseScroll",this.mouse.bind(this)),t.addEventListener("contextmenu",function(t){return t.preventDefault()},!1)},t.prototype.mouse=function(t){s.default.pos.x=t.offsetX,s.default.pos.y=t.offsetY,void 0===s.default.pos.x&&(s.default.pos.x=t.clientX,s.default.pos.y=t.clientY),s.default.pos.alt=t.altKey,s.default.pos.shift=t.shiftKey,s.default.pos.ctrl=t.ctrlKey,"mousedown"===t.type?(t.preventDefault(),s.default.pos.buttonRaw|=s.default.pos.buttons[t.which-1]):"mouseup"===t.type?s.default.pos.buttonRaw&=s.default.pos.buttons[t.which+2]:"mouseout"===t.type?(s.default.pos.buttonRaw=0,s.default.pos.over=!1):"mouseover"===t.type?s.default.pos.over=!0:"mousewheel"===t.type?(t.preventDefault(),s.default.pos.w=t.wheelDelta):"DOMMouseScroll"===t.type&&(s.default.pos.w=-t.detail),s.default.control.kit.update()},t}();e.default=r},67:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){void 0===t&&(t=1e3/240);var e=this;this.frame=0,this.lastTime=0,this.framerate=t,this.loop=function(i){e.frame+=Math.round((i-e.lastTime)/t),e.lastTime=i,e.update(),e.start()}}return t.prototype.stop=function(){cancelAnimationFrame(this.loop)},t.prototype.start=function(){requestAnimationFrame(this.loop)},t}();e.default=o},68:function(t,e,i){},69:function(t,e,i){t.exports=i.p+"img/dungeon.png"},70:function(t,e,i){"use strict";i.r(e);var o=i(36),s=i.n(o);i(9);new s.a;i(68),i(69)},9:function(t,e,i){"use strict";var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(i(40)),r=new(function(){function t(){this.canvas=document.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.width=window.innerWidth,this.height=window.innerHeight,this.img=new Image,this.gridSize=98,this.cellSize={w:this.width/this.gridSize*9/16,h:this.height/this.gridSize},this.rooms=new Array,this.grid=new Array,this.control=new s.default,this.pos={buttons:[1,2,4,6,5,3],x:0,y:0,w:0,alt:!1,shift:!1,ctrl:!1,buttonLastRaw:0,buttonRaw:0,over:!1,mouseX:0,mouseY:0}}return t.prototype.resize=function(t,e){void 0===t&&(t=window.innerWidth),void 0===e&&(e=window.innerHeight),this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e},t.prototype.buildGrid=function(){for(var t=0;t<r.gridSize;++t){this.grid[t]=new Array;for(var e=0;e<r.gridSize;++e)this.grid[t][e]=0}},t.prototype.loadImg=function(t,e){var i=this,o=new Image;o.src=t,o.onload=function(){i.img=o,e()}},t}());e.default=r}});